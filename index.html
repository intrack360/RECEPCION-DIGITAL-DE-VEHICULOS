<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recepci√≥n Digital de Veh√≠culos - Intrack360</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .header img {
      width: 90px;
    }
    h1 {
      text-align: center;
      color: #1976d2;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      max-width: 950px;
      margin: auto;
    }
    input, textarea, select {
      width: 100%;
      margin: 8px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .seccion {
      margin-bottom: 20px;
    }
    .foto-preview {
      max-height: 100px;
      margin-top: 5px;
      display: block;
    }
    button {
      background-color: #1976d2;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #135ba1;
    }
    .small-text {
      color: #666;
      font-size: 12px;
      margin-top: 5px;
    }
    .recuadro-evidencia {
      border: 1px dashed #1976d2;
      padding: 10px;
      margin-top: 10px;
      border-radius: 8px;
      text-align: center;
    }
    .mensajePlacas {
      font-size: 13px;
      color: #666;
      margin-top: 5px;
      display: none;
    }
  </style>
</head>
<body>
<div class="header">
  <h1>Recepci√≥n de Veh√≠culos</h1>
  <img src="https://github.com/intrack360/RECEPCION-DIGITAL-DE-VEHICULOS/blob/main/logo%20INTRACK%20360.png?raw=true" alt="Logo Intrack360">
</div>

<div style="text-align:center; margin-top:10px; font-size:18px; font-weight:bold;">
  Folio Actual: <span id="folioActual">Cargando...</span>
</div>

<form id="recepcionForm">
  
  <div class="seccion">
    <h2>Datos del Cliente</h2>
    <input type="text" id="nombreCliente" placeholder="Nombre completo" required>
    <input type="text" id="telefonoCliente" placeholder="Tel√©fono" required>
    <input type="text" id="poblacionCliente" placeholder="Poblaci√≥n" required>
  </div>

  <div class="seccion">
    <h2>Datos del Veh√≠culo</h2>
    <input type="text" id="marcaVehiculo" placeholder="Marca" required>
    <input type="text" id="modeloVehiculo" placeholder="Modelo" required>
    <input type="text" id="anioVehiculo" placeholder="A√±o" required>
    <input type="text" id="motorVehiculo" placeholder="Motor" required>
    <input type="text" id="cilindradaVehiculo" placeholder="Cilindrada" required>
    <input type="text" id="placasVehiculo" placeholder="Placas (sin guiones ni espacios)" required oninput="buscarPlacas()">
    <div id="mensajePlacas" class="mensajePlacas">Placas no registradas. Ingresar datos nuevos.</div>
  </div>

  <div class="seccion">
    <h2>Presupuesto y Anticipo</h2>
    <input type="number" id="presupuesto" placeholder="Presupuesto estimado" required>
    <input type="number" id="anticipo" placeholder="Anticipo recibido" required>
    <input type="text" id="fechaEntregaEstimada" placeholder="Fecha estimada de entrega (opcional)">
  </div>

  <div class="seccion">
    <h2>Observaciones</h2>
    <textarea id="observaciones" rows="4" placeholder="Aqui puedes anotar si el auto llego mal y que no puedes probarlo para garantizarle los demas sistemas"></textarea>
  </div>

</div>

<!-- Foto Frente -->
<label>Foto Frente:</label><br>
<input type="file" id="fotoFrente" onchange="mostrarVistaPrevia(this, 'previewfotoFrente')"><br>
<img id="previewfotoFrente" style="display:none; width: 100px; margin-top: 5px;"><br><br>

<!-- Foto Trasera -->
<label>Foto Trasera:</label><br>
<input type="file" id="fotoTrasera" onchange="mostrarVistaPrevia(this, 'previewfotoTrasera')"><br>
<img id="previewfotoTrasera" style="display:none; width: 100px; margin-top: 5px;"><br><br>

<!-- Foto Lado Derecho -->
<label>Foto Lado Derecho:</label><br>
<input type="file" id="fotoDerecho" onchange="mostrarVistaPrevia(this, 'previewfotoDerecho')"><br>
<img id="previewfotoDerecho" style="display:none; width: 100px; margin-top: 5px;"><br><br>

<!-- Foto Lado Izquierdo -->
<label>Foto Lado Izquierdo:</label><br>
<input type="file" id="fotoIzquierdo" onchange="mostrarVistaPrevia(this, 'previewfotoIzquierdo')"><br>
<img id="previewfotoIzquierdo" style="display:none; width: 100px; margin-top: 5px;"><br><br>

<!-- Foto Llaves del Veh√≠culo -->
<label>Foto Llaves del Veh√≠culo:</label><br>
<input type="file" id="fotoLlaves" onchange="mostrarVistaPrevia(this, 'previewfotoLlaves')"><br>
<img id="previewfotoLlaves" style="display:none; width: 100px; margin-top: 5px;"><br><br>

<!-- Foto Bater√≠a del Veh√≠culo -->
<label>Foto Bater√≠a del Veh√≠culo:</label><br>
<input type="file" id="fotoBateria" onchange="mostrarVistaPrevia(this, 'previewfotoBateria')"><br>
<img id="previewfotoBateria" style="display:none; width: 100px; margin-top: 5px;"><br><br>

    </div>

  </div>

  <div class="seccion">
    <h2>Video del Veh√≠culo</h2>
    <input type="file" id="videoVehiculo" accept="video/*" capture="environment">
  </div>
<!-- Observaci√≥n libre adicional -->
<div class="seccion">
  <textarea id="observacionLibre" name="observacionLibre" rows="4" placeholder="Escribe aqu√≠ cualquier detalle adicional no contemplado en los campos predise√±ados..." style="width:100%; resize: vertical;"></textarea>
</div>

  <div class="seccion" style="margin-top: 30px;">
  <h2 style="margin-bottom: 10px;">Condiciones Generales (Cl√°usulas):</h2>
  <div style="font-size: 0.67em; line-height: 1.5; color: #333; border: 1px solid #ccc; padding: 10px; border-radius: 5px; background-color: #f9f9f9;">
    ‚Ä¢ El taller no se hace responsable por objetos no declarados.<br>
    ‚Ä¢ Si no se acepta el presupuesto, se cobrar√° diagn√≥stico, y el taller se obligara a tratar de entregar el vehiculo como fue recibido, o desarmado si se requirio.exceptuando las consecuencias inevitables de la revision por el estado de deterioro de las piezas.<br>
    ‚Ä¢ Despu√©s de 24 horas de avisado de la terminaci√≥nde su trabajo, o 48 horas de abandono del seguimiento por parte del cliente, la pensi√≥n del veh√≠culo ser√° de $50.00 pesos por d√≠a.<br>
    ‚Ä¢ El taller no se hace responsable de da√±os meteorol√≥gicos, vandalismo o causas externas en autos abandonados.<br>
    ‚Ä¢ No nos responsabilizamos por la integridad de piezas resecas, deterioradas o quebradizas del motor que puedan fracturarse al manipularse, como uniones tomas de agua ductos de plastico.
  </div>
  </div>

  <button type="submit">Guardar Recepci√≥n</button>
</form>

<audio id="bipSuccess" src="https://assets.mixkit.co/active_storage/sfx/1106/1106-preview.mp3"></audio>
<script>
  let registros = {};
  
  function buscarPlacas() {
    const placas = document.getElementById('placasVehiculo').value.trim().toUpperCase();
    const mensaje = document.getElementById('mensajePlacas');
  
    if (placas && registros[placas]) {
      const datos = registros[placas];
      document.getElementById('nombreCliente').value = datos.nombreCliente;
      document.getElementById('telefonoCliente').value = datos.telefonoCliente;
      document.getElementById('poblacionCliente').value = datos.poblacionCliente;
      document.getElementById('marcaVehiculo').value = datos.marcaVehiculo;
      document.getElementById('modeloVehiculo').value = datos.modeloVehiculo;
      document.getElementById('anioVehiculo').value = datos.anioVehiculo;
      document.getElementById('motorVehiculo').value = datos.motorVehiculo;
      document.getElementById('cilindradaVehiculo').value = datos.cilindradaVehiculo;
      mensaje.style.display = "none";
    } else if (placas) {
      mensaje.style.display = "block";
    } else {
      mensaje.style.display = "none";
    }
  }
  
  document.getElementById('recepcionForm').addEventListener('submit', function(e) {
    e.preventDefault();
  
    const nombreCliente = document.getElementById('nombreCliente').value.trim();
    const telefonoCliente = document.getElementById('telefonoCliente').value.trim();
    const poblacionCliente = document.getElementById('poblacionCliente').value.trim();
    const marcaVehiculo = document.getElementById('marcaVehiculo').value.trim();
    const modeloVehiculo = document.getElementById('modeloVehiculo').value.trim();
    const anioVehiculo = document.getElementById('anioVehiculo').value.trim();
    const motorVehiculo = document.getElementById('motorVehiculo').value.trim();
    const cilindradaVehiculo = document.getElementById('cilindradaVehiculo').value.trim();
    const placasVehiculo = document.getElementById('placasVehiculo').value.trim().toUpperCase();
    const presupuesto = parseFloat(document.getElementById('presupuesto').value);
    const anticipo = parseFloat(document.getElementById('anticipo').value);
    const fechaEntregaEstimada = document.getElementById('fechaEntregaEstimada').value.trim();
    const observaciones = document.getElementById('observaciones').value.trim();
    const clausulas = document.getElementById('clausulas').value.trim();
  
    if (!placasVehiculo) {
      alert('üö´ Debes ingresar las placas del veh√≠culo.');
      return;
    }
  
    registros[placasVehiculo] = {
      nombreCliente,
      telefonoCliente,
      poblacionCliente,
      marcaVehiculo,
      modeloVehiculo,
      anioVehiculo,
      motorVehiculo,
      cilindradaVehiculo,
      placasVehiculo,
      presupuesto,
      anticipo,
      fechaEntregaEstimada,
      observaciones,
      clausulas
    };
  
    document.getElementById('bipSuccess').play();
    alert('‚úÖ Recepci√≥n guardada exitosamente.');
  
    setTimeout(() => {
      window.location.reload();
    }, 1000);
  });
  </script>
  <script>
  // Generar folio tipo TAL001-0001 autom√°ticamente
  document.addEventListener("DOMContentLoaded", () => {
    const folioSpan = document.getElementById("folioActual");

    // Obtener el √∫ltimo folio guardado en localStorage o iniciar desde 1
    let ultimoFolio = localStorage.getItem("ultimoFolioTaller") || "TAL001-0000";

    // Extraer el n√∫mero actual y sumarle 1
    const partes = ultimoFolio.split("-");
    const nuevoNumero = String(parseInt(partes[1]) + 1).padStart(4, "0");
    const nuevoFolio = `${partes[0]}-${nuevoNumero}`;

    // Mostrar en pantalla
    folioSpan.textContent = nuevoFolio;

    // Guardar nuevo folio para siguiente vez
    localStorage.setItem("ultimoFolioTaller", nuevoFolio);
  });
</script>
<script>
  function mostrarVistaPrevia(input, idImagen) {
    const archivo = input.files[0];
    if (archivo) {
      const reader = new FileReader();
      reader.onload = function (e) {
        const imgPreview = document.getElementById(idImagen);
        imgPreview.src = e.target.result;
        imgPreview.style.display = 'block';
      };
      reader.readAsDataURL(archivo);
    }
  }
</script>

  </body>
  </html>
  
